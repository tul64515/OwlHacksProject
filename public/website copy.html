<!DOCTYPE html>
<html> 
    <head>
        <link rel = "stylesheet" href = "styles.css">
        
    </head>
    <style>

        button{
            display: flex;
        }


        table, th, td{
                border: 3px solid black;
                border-collapse: collapse;
                height: 100%;
                text-align: center;
                background-color: pink;
            }

        th, td{
            padding-left: 5px;
            padding-right: 5px;
        }

        table{
        display: block;
        max-width: 400px;
        height: 400px;
        overflow: auto;
        }

        th{
            position: sticky;
            top: 0;
        }

        .content{
            display: flex;
            flex-direction: row;
        }

        .details{
            display: flex;
            flex-direction: column;
        }

        .img_zoom{
                display: flex;
                justify-content: center;
                align-items: center;
                transition: transform .2s;
                cursor: pointer;
        }
            .img_zoom:hover{
                transform: scale(1.1);
            }

        .legend{
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
        }

            .l_ind{
                display: flex;
                flex-direction: column;
                margin: 5px;
            }

            .l_ind_text{
                font-family: Ubuntu;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .l_ind_pic{
                display: flex;
                justify-content: center;
                align-items: center;
            }


        .map{
            padding-left: 10px;
        }

        

    </style>
    <body>
        <div class = "contain-all">
            <div class = "utility-row"> 
                <h1 class = "title" > Philly Hangout Spots </h1>
                <a class="home" href="website.html"> Home </a>
                <a class="random" href="random.html"> Random </a>
                <div> Popular </div>
                <a class="about" href="about.html"> About </a>
            </div>

            <div class="content">
                <div class = "map">
                    <iframe id = "google_map" src="https://www.google.com/maps/d/u/0/embed?mid=1y-Sj5SXntEakQRzVSsgEBSIMHzLut3M&ehbc=2E312F&noprof=1" width="640" height="480"></iframe>
                </div>

                <div class = "details">
                    <table id="data">
                        <tbody>
                            <tr>
                                <th>Location</th>
                                <th>Type</th>
                                <th>Bathrooms</th>
                                <th>Parking</th>
                                <th>See on Map</th>
                            </tr>
                            <tr>
                                <td>Matcha Panda</td>
                                <td>Cafe</td>
                                <td>Yes</td>
                                <td>No</td>
                                <td><div class="img_zoom"><img id="panda" src="Images/pin.png"></div></td>
                            </tr>
                            <tr>
                                <td>Rail Park</td>
                                <td>Park</td>
                                <td>No</td>
                                <td>No</td>
                                <td><div class="img_zoom"><img id="rail" src="Images/pin.png"></div></td>
                            </tr>
                            <tr>
                                <td>Elixir Coffee Roasters</td>
                                <td>cafe</td>
                                <td>Yes</td>
                                <td>No</td>
                                <td><div class="img_zoom"><img id="elixir" src="Images/pin.png"></div></td>
                            </tr>
                            <tr>
                                <td>Gryphon Cafe</td>
                                <td>Cafe</td>
                                <td>No</td>
                                <td>No</td>
                                <td><div class="img_zoom"><img id="gryphon" src="Images/pin.png"></div></td>
                            </tr>
                            <tr>
                                <td>Dilworth Park</td>
                                <td>Park</td>
                                <td>No</td>
                                <td>No</td>
                                <td><div class="img_zoom"><img id="dilworth" src="Images/pin.png"></div></td>
                            </tr>
                            <tr>
                                <td>Paris Baguette</td>
                                <td>Cafe</td>
                                <td>Yes</td>
                                <td>Yes</td>
                                <td><div class="img_zoom"><img id="paris" src="Images/pin.png"></div></td>
                            </tr>
                            <tr>
                                <td>Saxby's</td>
                                <td>Cafe</td>
                                <td>No</td>
                                <td>No</td>
                                <td><div class="img_zoom"><img id="saxby" src="Images/pin.png"></div></td>
                            </tr>
                            <tr>
                                <td>A La Mousse</td>
                                <td>Cafe</td>
                                <td>No</td>
                                <td>No</td>
                                <td><div class="img_zoom"><img id="mousse" src="Images/pin.png"></div></td>
                            </tr>
                            <tr>
                                <td>Paine's Park</td>
                                <td>Park</td>
                                <td>No</td>
                                <td>No</td>
                                <td><div class="img_zoom"><img id="paine" src="Images/pin.png"></div></td>
                            </tr>
                            <tr>
                                <td>Gong Cha</td>
                                <td>Cafe</td>
                                <td>Yes</td>
                                <td>No</td>
                                <td><div class="img_zoom"><img id="gong" src="Images/pin.png"></div></td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="legend">
                        <div class="l_ind">
                            <div class="l_ind_pic">
                                <img src="Images/bathroom.png">
                            </div>
                            <div class="l_ind_text">
                                Bathroom
                            </div>
                        </div>
                        <div class="l_ind">
                            <div class="l_ind_pic">
                                <img src="Images/no_bathroom.png">
                            </div>
                            <div class="l_ind_text">
                                No Bathrooms
                            </div>
                        </div>
                        <div class="l_ind">
                            <div class="l_ind_pic">
                                <img src="Images/cafe_parking.png">
                            </div>
                            <div class="l_ind_text">
                                Cafe
                            </div>
                        </div>
                        <div class="l_ind">
                            <div class="l_ind_pic">
                                <img src="Images/cafe_no_parking.png">
                            </div>
                            <div class="l_ind_text">
                                Cafe w/ No Parking
                            </div>
                        </div>
                        <div class="l_ind">
                            <div class="l_ind_pic">
                                <img src="Images/park_parking.png">
                            </div>
                            <div class="l_ind_text">
                                Park
                            </div>
                        </div>
                        <div class="l_ind">
                            <div class="l_ind_pic">
                                <img src="Images/park_no_parking.png">
                            </div>
                            <div class="l_ind_text">
                                Park w/ No Parking
                            </div>
                        </div>
                    </div>

                </div>

            
        </div>
    </body>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <script>

async function fetchData() {
            try {
                // Fetch data from the backend
                const response = await fetch('/data'); // Relative path since frontend is served by backend
                console.log('Fetch response status:', response.status);

                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }

                const jsonData = await response.json();
                console.log('Response JSON:', jsonData);

                // Check if locations exist and is an array
                if (jsonData.locations && Array.isArray(jsonData.locations)) {
                    const locations = jsonData.locations;
                    console.log('Number of locations:', locations.length);

                    const dataList = document.getElementById('data-list');
                    dataList.innerHTML = ''; // Clear any existing data

                    // Iterate over each location and create list items
                    locations.forEach((item, index) => {
                        console.log(`Processing location ${index + 1}:`, item);

                        const li = document.createElement('li');

                        li.innerHTML = `
                            <strong>Name:</strong> ${item.name}<br>
                            <strong>Type:</strong> ${item.type}<br>
                            <strong>Hours:</strong> ${item.hours}<br>
                            <strong>Restroom:</strong> ${item.restroom}<br>
                            <strong>Parking:</strong> ${item.parking}<br>
                            <strong>Rating:</strong> ${item.rating !== null ? item.rating + ' ⭐' : 'N/A'}<br>
                            <hr>
                        `;
                        dataList.appendChild(li);
                    });
                } else {
                    console.error('Locations array not found or is not an array in the response');
                    const dataList = document.getElementById('data-list');
                    dataList.innerHTML = '<li>No locations available.</li>';
                }
            } catch (error) {
                console.error('Error fetching data:', error);
                const dataList = document.getElementById('data-list');
                dataList.innerHTML = `<li style="color: red;">Error fetching data: ${error.message}</li>`;
            }
        }

        fetchData();

        // function change_rail() {
        //     if (document.getElementById("google_map").src != {
        //         document.getElementById("google_map").src = "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d24436.160398791028!2d-75.12551601420003!3d40.041493931144814!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89c6b657c88235fb%3A0xef856160cecf6fa7!2sThe%20Home%20Depot!5e0!3m2!1sen!2sus!4v1728163307132!5m2!1sen!2sus";
        //     }else{
        //         document.getElementById("google_map").src = "https://www.google.com/maps/d/u/0/embed?mid=1y-Sj5SXntEakQRzVSsgEBSIMHzLut3M&ehbc=2E312F&noprof=1";
        //     }
        // }

        // Map switching functions and event listeners
        panda.addEventListener("click", change_pan);
        rail.addEventListener("click", change_rail);
        elixir.addEventListener("click",change_eli);
        gryphon.addEventListener("click",change_gry)
        dilworth.addEventListener("click",change_dil)
        saxby.addEventListener("click",change_sax);
        mousse.addEventListener("click",change_mou);
        paine.addEventListener("click",change_pai);
        gong.addEventListener("click",change_gong);

        function change_pan() {
            if (document.getElementById("google_map").src != "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3058.3753221887077!2d-75.15699902529406!3d39.955360583592814!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89c6c9ecc2adf487%3A0x794e1e27795080d3!2sMatcha%20Panda%20Cafe!5e0!3m2!1sen!2sus!4v1728218806879!5m2!1sen!2sus"){
                document.getElementById("google_map").src = "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3058.3753221887077!2d-75.15699902529406!3d39.955360583592814!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89c6c9ecc2adf487%3A0x794e1e27795080d3!2sMatcha%20Panda%20Cafe!5e0!3m2!1sen!2sus!4v1728218806879!5m2!1sen!2sus";
            }else{
                document.getElementById("google_map").src = "https://www.google.com/maps/d/u/0/embed?mid=1y-Sj5SXntEakQRzVSsgEBSIMHzLut3M&ehbc=2E312F&noprof=1";
            }

        }

        function change_rail() {
            if (document.getElementById("google_map").src != "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3058.160667311369!2d-75.16375107304691!3d39.9601604!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89c6c7dc25ea5f13%3A0x456041fc06e8e739!2sThe%20Rail%20Park!5e0!3m2!1sen!2sus!4v1728218864667!5m2!1sen!2sus"){
                document.getElementById("google_map").src = "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3058.160667311369!2d-75.16375107304691!3d39.9601604!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89c6c7dc25ea5f13%3A0x456041fc06e8e739!2sThe%20Rail%20Park!5e0!3m2!1sen!2sus!4v1728218864667!5m2!1sen!2sus";
            }else{
                document.getElementById("google_map").src = "https://www.google.com/maps/d/u/0/embed?mid=1y-Sj5SXntEakQRzVSsgEBSIMHzLut3M&ehbc=2E312F&noprof=1";
            }
        }

        function change_eli() {
            if (document.getElementById("google_map").src != "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d97836.90320848493!2d-75.2250409616423!3d39.97709344208419!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89c6c784876f8db9%3A0xd93c0122f3f0d026!2sElixr%20Coffee%20Roasters!5e0!3m2!1sen!2sus!4v1728218406794!5m2!1sen!2sus"){
                document.getElementById("google_map").src = "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d97836.90320848493!2d-75.2250409616423!3d39.97709344208419!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89c6c784876f8db9%3A0xd93c0122f3f0d026!2sElixr%20Coffee%20Roasters!5e0!3m2!1sen!2sus!4v1728218406794!5m2!1sen!2sus";
            }else{
                document.getElementById("google_map").src = "https://www.google.com/maps/d/u/0/embed?mid=1y-Sj5SXntEakQRzVSsgEBSIMHzLut3M&ehbc=2E312F&noprof=1";
            }
        }

    </script>
</html>
